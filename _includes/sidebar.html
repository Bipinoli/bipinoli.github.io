<div class="sidebar">
    <h3>All posts</h3>
    {% assign postsByYear = site.posts | group_by_exp:"post", "post.date | date: '%Y'"  %}
    {% for year in postsByYear %}
      <p>{{ year.name }}</p>
        <ul>
          {% for post in year.items %}
            <li><a href="{{ post.url }}" {% if page.url == post.url %} class="current-post" {% endif %}>{{ post.title }}</a></li>
          {% endfor %}
        </ul>
    {% endfor %}
</div>
